<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>3 Creating the package infrastructure | Writing an R package</title>
<meta name="author" content="Richard J Telford">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="3 Creating the package infrastructure | Writing an R package">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="3 Creating the package infrastructure | Writing an R package">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="css/style-chapters.css">
<meta name="description" content="A package starts life as a directory with some files and subdirectories that R expects. There is nothing to stop you building the whole thing from scratch. But it is so much easier to get some...">
<meta property="og:description" content="A package starts life as a directory with some files and subdirectories that R expects. There is nothing to stop you building the whole thing from scratch. But it is so much easier to get some...">
<meta name="twitter:description" content="A package starts life as a directory with some files and subdirectories that R expects. There is nothing to stop you building the whole thing from scratch. But it is so much easier to get some...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Writing an R package</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="system-setup.html"><span class="header-section-number">2</span> System setup</a></li>
<li><a class="active" href="creating-the-package-infrastructure.html"><span class="header-section-number">3</span> Creating the package infrastructure</a></li>
<li><a class="" href="contents.html"><span class="header-section-number">4</span> Contents</a></li>
<li><a class="" href="more-documentation.html"><span class="header-section-number">5</span> More documentation</a></li>
<li><a class="" href="distributing-your-package.html"><span class="header-section-number">6</span> Distributing your package</a></li>
<li><a class="" href="troubleshooting.html"><span class="header-section-number">7</span> Troubleshooting</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="creating-the-package-infrastructure" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Creating the package infrastructure<a class="anchor" aria-label="anchor" href="#creating-the-package-infrastructure"><i class="fas fa-link"></i></a>
</h1>
<p>A package starts life as a directory with some files and subdirectories that R expects.
There is nothing to stop you building the whole thing from scratch.
But it is <em>so</em> much easier to get some help from <code>usethis</code>.</p>
<p>The <code>create_package</code> function takes the path of the project you want to write, creates this directory, add adds some files and subdirectories.</p>
<p>The name of the directory will become the name of the package.
Choose carefully as it is easier to get it right now than change it later.
There are special rules for naming packages</p>
<ul>
<li>Contain only ASCII letters, numbers, and ‘.’</li>
<li>Have at least two characters</li>
<li>Start with a letter</li>
<li>Not end with ‘.’</li>
</ul>
<p>The function <code><a href="https://rdrr.io/pkg/available/man/available.html">available::available()</a></code> can tell you if your name is valid and if it clashes with an existing package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">available</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/available/man/available.html">available</a></span><span class="op">(</span><span class="st">"helper"</span><span class="op">)</span></code></pre></div>
<p>Once you have chosen your name, you can create the skeleton of your package.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Choose a path on your computer</span>
<span class="co"># My package will be called DemoPackage</span>
<span class="va">package_path</span> <span class="op">=</span> <span class="st">"/home/gbsrt/Documents/teaching/DemoPackage"</span>
<span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/create_package.html">create_package</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">package_path</span><span class="op">)</span></code></pre></div>
<p>When you run this, it will open a new RStudio session.
The files tab should look something like this.</p>
<ul>
<li>
<code>.gitignore</code> - which files should git ignore</li>
<li>
<code>.Rbuildignore</code> - When R builds a package, it does not like unexpected files. This <code>.Rbuildignore</code> tells it which ones it can ignore.</li>
<li>
<code>DemoPackage.Rproj</code> - an Rstudio project</li>
<li>
<code>DESCRIPTION</code> - metadata about the package</li>
<li>
<code>NAMESPACE</code> - Which functions are to be imported/exported. It is automatically generated so don’t edit this file by hand, but delete it if it becomes corrupt.</li>
<li>
<code>R</code> - a folder for your R code</li>
</ul>
<p>Almost everything concerned with setting up a package is easier with the <code>usethis</code> package.
We are going to be using it a lot, so it is a good idea to load it now.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://usethis.r-lib.org">usethis</a></span><span class="op">)</span></code></pre></div>
<div id="description-file" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> DESCRIPTION file<a class="anchor" aria-label="anchor" href="#description-file"><i class="fas fa-link"></i></a>
</h2>
<p>The <code>DESCRIPTION</code> file contains the information used by CRAN to make the package page there (see for example <a href="https://cran.r-project.org/web/packages/devtools/index.html">devtools</a>).</p>
<p>Start by editing the title, author and description fields of the <code>DESCRIPTION</code> files.
The title field must be in title case (they really do check this when you submit to CRAN).</p>
<pre><code>Package: DemoPackage
Title: What the Package Does (One Line, Title Case)
Version: 0.0.0.9000
Authors@R: 
    person(given = "First",
           family = "Last",
           role = c("aut", "cre"),
           email = "first.last@example.com",
           comment = c(ORCID = "YOUR-ORCID-ID"))
Description: What the package does (one paragraph).
License: `use_mit_license()`, `use_gpl3_license()` or friends to pick a
    license
Encoding: UTF-8
LazyData: true
Roxygen: list(markdown = TRUE)
RoxygenNote: 7.1.1</code></pre>
<p>When you have finished, be sure to save the file otherwise your changes will be over-written.</p>
</div>
<div id="choose-a-licence" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Choose a licence<a class="anchor" aria-label="anchor" href="#choose-a-licence"><i class="fas fa-link"></i></a>
</h2>
<p>You need to set a licence for your package otherwise, legally, no-one will be allowed to make a copy and use it.</p>
<p>Frequently used open source licences for R packages are</p>
<ul>
<li>
<a href="https://choosealicense.com/licenses/mit/">MIT licence</a> is a permissive licence, letting people do almost anything (including use, copy, modify, merge, publish, distribute, sublicense, or sell) with the software.
Generate with <code><a href="https://usethis.r-lib.org/reference/licenses.html">use_mit_license()</a></code>
</li>
<li>
<a href="https://choosealicense.com/licenses/gpl-3.0/">GPL licence</a> lets people do almost anything <em>except</em> distributing closed source versions.
Generate with <code><a href="https://usethis.r-lib.org/reference/licenses.html">use_gpl_license()</a></code>
</li>
</ul>
<p>I generally use the MIT licence.
Data packages probably should use a <code>CC0</code> licence.</p>
<p>For more information about licences, see the <a href="https://r-pkgs.org/license.html">R package book</a> and <a href="https://choosealicense.com/">Choose a License</a></p>
</div>
<div id="git-and-github" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> git and GitHub<a class="anchor" aria-label="anchor" href="#git-and-github"><i class="fas fa-link"></i></a>
</h2>
<p>You don’t have to use git and GitHub when writing a package, but there are many advantages if you are do.</p>
<p>You are probably aware of some of these</p>
<ul>
<li>Version control</li>
<li>Collaboration</li>
<li>Issue tracking - for bug reports or feature requests</li>
<li>Distribution - people can install your package directly from CRAN.</li>
</ul>
<p>A fourth is that you can use GitHub actions.
GitHub actions will perform some action on your repo.
For example, with <code><a href="https://usethis.r-lib.org/reference/use_github_action.html">use_github_action_check_standard()</a></code> we can check the package works on the latest version of R on linux, macOS and Windows every time we push a commit.
This is essential if you want your package to be released on CRAN, but useful anyway, as it can find problems that are not apparent on your own computer.</p>
<p>See the git and GitHub tutorial for how to make a GitHub repo for your package.
To set up GitHub actions, just run the following command, then commit and push.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://usethis.r-lib.org/reference/use_github_action.html">use_github_action_check_standard</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="system-setup.html"><span class="header-section-number">2</span> System setup</a></div>
<div class="next"><a href="contents.html"><span class="header-section-number">4</span> Contents</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
<style>
               img.site-logo {
  height: auto;
  width: 95%;
}
      </style>
<p><a  href="https://biostats.w.uib.no/" aria-label="bioST@TS | When biology adds up, at last&#8230;"><img class="site-logo" src="https://biostats.w.uib.no/files/2020/01/biostats-button-res2.png" alt="BioST@TS homepage" width="250" height="101"  data-no-retina class=" attachment-11864" title = "BioST@TS homepage"/></a>   </p>
<p><a  href="../index.html" aria-label="bioST@TS | When biology adds up, at last&#8230;"><img class="site-logo" src="../figures/icons_all.png" alt= "BioST@TS books" width="250" height="101"  data-no-retina class=" attachment-11864", title = "BioST@TS books"/></a>   </p>
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#creating-the-package-infrastructure"><span class="header-section-number">3</span> Creating the package infrastructure</a></li>
<li><a class="nav-link" href="#description-file"><span class="header-section-number">3.1</span> DESCRIPTION file</a></li>
<li><a class="nav-link" href="#choose-a-licence"><span class="header-section-number">3.2</span> Choose a licence</a></li>
<li><a class="nav-link" href="#git-and-github"><span class="header-section-number">3.3</span> git and GitHub</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Writing an R package</strong>" was written by Richard J Telford. It was last built on 2022-03-10.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
