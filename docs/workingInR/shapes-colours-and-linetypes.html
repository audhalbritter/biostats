<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>14 Shapes, colours and linetypes | Working in R</title>
<meta name="author" content="Jonathan Soulé, Aud Halbritter and Richard J Telford">
<meta name="description" content="14.1 Colours and fill The colour aesthetic give colour for points and lines, while the fill aesthetic gives colour to areas. It is very easy to forget this. ggplot(penguins, aes(x =...">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="14 Shapes, colours and linetypes | Working in R">
<meta property="og:type" content="book">
<meta property="og:description" content="14.1 Colours and fill The colour aesthetic give colour for points and lines, while the fill aesthetic gives colour to areas. It is very easy to forget this. ggplot(penguins, aes(x =...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="14 Shapes, colours and linetypes | Working in R">
<meta name="twitter:description" content="14.1 Colours and fill The colour aesthetic give colour for points and lines, while the fill aesthetic gives colour to areas. It is very easy to forget this. ggplot(penguins, aes(x =...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/panelset-0.2.6/panelset.css" rel="stylesheet">
<script src="libs/panelset-0.2.6/panelset.js"></script><link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="css/style-chapters.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Working in R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Introduction</a></li>
<li class="book-part">Setting up R and RStudio</li>
<li><a class="" href="getting-started-with-r.html"><span class="header-section-number">2</span> Getting started with R</a></li>
<li class="book-part">First steps in R</li>
<li><a class="" href="first-steps-in-r.html"><span class="header-section-number">3</span> First steps in R</a></li>
<li><a class="" href="importing-data-in-r.html"><span class="header-section-number">4</span> Importing data in R</a></li>
<li class="book-part">Data manipulation with the tidyverse</li>
<li><a class="" href="pipes.html"><span class="header-section-number">5</span> Pipes</a></li>
<li><a class="" href="tidying-data-with-tidyr.html"><span class="header-section-number">6</span> Tidying data with tidyr</a></li>
<li><a class="" href="working-with-single-tables-in-dplyr.html"><span class="header-section-number">7</span> Working with single tables in dplyr</a></li>
<li><a class="" href="working-with-multiple-tables-in-dplyr.html"><span class="header-section-number">8</span> Working with multiple tables in dplyr</a></li>
<li class="book-part">Data visualisation</li>
<li><a class="" href="why-is-data-visualization-important.html"><span class="header-section-number">10</span> Why is data visualization important?</a></li>
<li><a class="" href="getting-started-with-ggplot.html"><span class="header-section-number">11</span> Getting started with ggplot</a></li>
<li><a class="" href="types-of-vizualization.html"><span class="header-section-number">12</span> Types of vizualization</a></li>
<li><a class="" href="themes-1.html"><span class="header-section-number">13</span> Themes</a></li>
<li><a class="active" href="shapes-colours-and-linetypes.html"><span class="header-section-number">14</span> Shapes, colours and linetypes</a></li>
<li><a class="" href="combining-plots.html"><span class="header-section-number">15</span> Combining plots</a></li>
<li><a class="" href="using-functions-and-packages.html"><span class="header-section-number">16</span> Using functions and packages</a></li>
<li class="book-part">Other topics</li>
<li><a class="" href="handling-missing-values.html"><span class="header-section-number">17</span> Handling missing values</a></li>
<li><a class="" href="bestiary-of-brackets-and-other-r-notation.html"><span class="header-section-number">18</span> Bestiary of Brackets and other R notation</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="shapes-colours-and-linetypes" class="section level1" number="14">
<h1>
<span class="header-section-number">14</span> Shapes, colours and linetypes<a class="anchor" aria-label="anchor" href="#shapes-colours-and-linetypes"><i class="fas fa-link"></i></a>
</h1>
<div id="colours-and-fill" class="section level2" number="14.1">
<h2>
<span class="header-section-number">14.1</span> Colours and fill<a class="anchor" aria-label="anchor" href="#colours-and-fill"><i class="fas fa-link"></i></a>
</h2>
<p>The <code>colour</code> aesthetic give colour for points and lines, while the <code>fill</code> aesthetic gives colour to areas.
It is very easy to forget this.</p>
<div class="sourceCode" id="cb498"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bill_length_mm</span>, colour <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:wrong-aes"></span>
<img src="working-in-R-bookdown_files/figure-html/wrong-aes-1.png" alt="Use fill for areas." width="336"><p class="caption">
Figure 14.1: Use fill for areas.
</p>
</div>
<p>You can set the colour of points or lines and the fill of areas by setting it in the <code>geom_*()</code> used.</p>
<div class="sourceCode" id="cb499"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"purple"</span>, fill <span class="op">=</span> <span class="st">"pink"</span><span class="op">)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with
## `binwidth`.</code></pre>
<div class="inline-figure"><img src="working-in-R-bookdown_files/figure-html/fill-colour-set-1.png" width="336"></div>
<p>If you map a variable to the <code>colour</code> aesthetic, for points and lines, or the <code>fill</code> aesthetics for areas, ggplot will give you different colours/fills for the different values in the variable.
If you don’t like the default colours/fills, and you shouldn’t because they are not colour blind friendly, then you can change them with a <code>scale_colour_*()</code> or <code>scale_fill_*</code>.
First you need to decide what type of colour/fill scale you need.</p>
<p>The first decision is whether the scale should be continuous or discrete.</p>
<div id="discrete-colourfill-scales" class="section level3" number="14.1.1">
<h3>
<span class="header-section-number">14.1.1</span> Discrete colour/fill scales<a class="anchor" aria-label="anchor" href="#discrete-colourfill-scales"><i class="fas fa-link"></i></a>
</h3>
<p>Discrete scales are automatically used when the variable mapped to colour or fill is a character or factor variable.
If you want to use a discrete scale on a numeric variable, for example, if 0 represents Male and 1 represents Female (this is a bad idea), then you need to coerce it to a factor with <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code>.
If you don’t do this, you will get an error.</p>
<p>There is a choice of three types of discrete colour/fill scales</p>
<ul>
<li>
<a href="qualitative">Qualitative</a> for categorical variables</li>
<li>
<a href="sequential">Sequential</a> for ordinal variables</li>
<li>
<a href="diverging">Diverging</a> for ordinal variables with a natural midpoint.</li>
</ul>
</div>
<div id="qualitative" class="section level3" number="14.1.2">
<h3>
<span class="header-section-number">14.1.2</span> Qualitative<a class="anchor" aria-label="anchor" href="#qualitative"><i class="fas fa-link"></i></a>
</h3>
<p>Qualitative palettes have no natural order to the colours.
Use them for categorical variables.
In the <code>penguins</code> dataset, species, island, and sex are categorical variables.</p>
<div class="sourceCode" id="cb501"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="working-in-R-bookdown_files/figure-html/unnamed-chunk-24-1.png" width="672"></div>
<p>You can change the default colours/fill by either picking your own colours with <code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_colour_manual()</a></code> or <code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual()</a></code>.</p>
<div class="sourceCode" id="cb502"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>Adelie <span class="op">=</span> <span class="st">"pink"</span>, Chinstrap <span class="op">=</span> <span class="st">"purple"</span>, Gentoo <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="working-in-R-bookdown_files/figure-html/unnamed-chunk-25-1.png" width="336"></div>
<p>Picking your own colours can be hard!</p>
<p>Normally better to use some built in qualitative palettes, for example these from the <code>RColorBrewer</code> package.</p>
<div class="sourceCode" id="cb503"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">display.brewer.all</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"qual"</span><span class="op">)</span></code></pre></div>
<p><img src="working-in-R-bookdown_files/figure-html/unnamed-chunk-26-1.png" width="672">
You can use these with <code><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_colour_brewer()</a></code> or <code><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer()</a></code></p>
<div class="sourceCode" id="cb504"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="working-in-R-bookdown_files/figure-html/unnamed-chunk-27-1.png" width="336"></div>
</div>
<div id="sequential" class="section level3" number="14.1.3">
<h3>
<span class="header-section-number">14.1.3</span> Sequential<a class="anchor" aria-label="anchor" href="#sequential"><i class="fas fa-link"></i></a>
</h3>
<p>Sequential colour/fill scales are useful for ordinal variables - for example, high, medium, and low concentrations of a treatment drug.</p>
<p>Here are some examples from the <code>RColorBrewer</code> package, which can be used as above.</p>
<div class="sourceCode" id="cb505"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">display.brewer.all</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"seq"</span><span class="op">)</span></code></pre></div>
<p><img src="working-in-R-bookdown_files/figure-html/unnamed-chunk-28-1.png" width="672">
Another example of a sequential colour/fill palette is viridis, which can be used with <code><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d()</a></code>.</p>
</div>
<div id="diverging" class="section level3" number="14.1.4">
<h3>
<span class="header-section-number">14.1.4</span> Diverging<a class="anchor" aria-label="anchor" href="#diverging"><i class="fas fa-link"></i></a>
</h3>
<p>Diverging colour/fill scales are useful for ordinal variables with a natural midpoint, which might be zero, or the mean of the data.</p>
<p>Here are some examples from the <code>RColorBrewer</code> package, which can be used as above.</p>
<div class="sourceCode" id="cb506"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">display.brewer.all</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"div"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="working-in-R-bookdown_files/figure-html/unnamed-chunk-29-1.png" width="672"></div>
</div>
<div id="continuous-colourfill-scales" class="section level3" number="14.1.5">
<h3>
<span class="header-section-number">14.1.5</span> Continuous colour/fill scales<a class="anchor" aria-label="anchor" href="#continuous-colourfill-scales"><i class="fas fa-link"></i></a>
</h3>
<p>Continuous colour/fill scales are used for continuous variables.
They can be directional or diverging.</p>
<p>You can make your own continuous colour/fill scales with <code><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_colour_gradient()</a></code> with two colours of your choice.
<code><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient2()</a></code> will make a diverging scale by adding a mid-point colour.</p>
<p>It can be better to use existing colour scales.
<code><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c()</a></code> is a popular continuous scale.
You can also use interpolated versions of <code>RColorBrewer</code> palettes with <code><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_distiller()</a></code>.</p>
<p>Continuous colour/fill scales also can be binned (just a a histogram bins the data on the x-axis) with <code><a href="https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html">scale_fill_binned()</a></code>, <code><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_b()</a></code>for binned viridis palettes, or <code><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_colour_fermenter()</a></code> for binned <code>RColorBrewer</code> palettes.</p>
<p>Here are many examples of colour palettes in the <code>paletteer</code> package</p>
</div>
<div id="colour-blind-friendly-colours" class="section level3" number="14.1.6">
<h3>
<span class="header-section-number">14.1.6</span> Colour blind friendly colours<a class="anchor" aria-label="anchor" href="#colour-blind-friendly-colours"><i class="fas fa-link"></i></a>
</h3>
<p>About 1/8 men and 1/200 women are colour blind.
We need to use colour and fill palettes that are colourblind friendly.
Some popular scales are not.
For example, we can use the <a href="https://github.com/clauswilke/colorblindr"><code>colorblindr</code> package</a> to simulate how this figure is percieved by people with different forms of colourblindness.</p>
<div class="sourceCode" id="cb507"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>, fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_fill_discrete</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">p3</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:not-colourblind-friendly"></span>
<img src="working-in-R-bookdown_files/figure-html/not-colourblind-friendly-1.png" alt="Default ggplot fill." width="336"><p class="caption">
Figure 14.2: Default ggplot fill.
</p>
</div>
<div class="sourceCode" id="cb508"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/clauswilke/colorblindr">colorblindr</a></span><span class="op">)</span></code></pre></div>
<pre><code>## Loading required package: colorspace</code></pre>
<div class="sourceCode" id="cb510"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/colorblindr/man/cvd_grid.html">cvd_grid</a></span><span class="op">(</span><span class="va">p3</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:colour-blindr-default"></span>
<img src="working-in-R-bookdown_files/figure-html/colour-blindr-default-1.png" alt="How people with different types of colourblindness see the default colour scale." width="672"><p class="caption">
Figure 14.3: How people with different types of colourblindness see the default colour scale.
</p>
</div>
<p>That was hopeless.
It won’t even print well in black and white (shown by the Desaturated panel).
Let’s try a different palette.</p>
<div class="sourceCode" id="cb511"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p3_v</span> <span class="op">&lt;-</span> <span class="va">p3</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">p3_v</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:viridis-colourblind"></span>
<img src="working-in-R-bookdown_files/figure-html/viridis-colourblind-1.png" alt="Viridis fill." width="336"><p class="caption">
Figure 14.4: Viridis fill.
</p>
</div>
<div class="figure">
<span style="display:block;" id="fig:viridis-colourblind2"></span>
<img src="working-in-R-bookdown_files/figure-html/viridis-colourblind2-1.png" alt="How people with different types of colourblindness see the viridis colour scale." width="672"><p class="caption">
Figure 14.5: How people with different types of colourblindness see the viridis colour scale.
</p>
</div>
<p>Much better.
Always test that your colour palette is colourblind friendly, or use one known to be ok.</p>
</div>
</div>
<div id="shapes" class="section level2" number="14.2">
<h2>
<span class="header-section-number">14.2</span> Shapes<a class="anchor" aria-label="anchor" href="#shapes"><i class="fas fa-link"></i></a>
</h2>
<p>You can change the shape of all the points made by, for example, <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> by setting the shape.</p>
<div class="sourceCode" id="cb512"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bill_length_mm</span>, y <span class="op">=</span> <span class="va">bill_depth_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="working-in-R-bookdown_files/figure-html/shape-set-1.png" width="288"></div>
<p>If you map a discrete variable to the <code>shape</code> aesthetic, points made by <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>, <code><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_pointrange()</a></code>, etc will have different shaped points for the different values in the variable.
Many of the shapes are difficult to distinguish when small, so it is usually best to use shape with colour to distinguish groups.
These are the available shapes.</p>
<div class="figure">
<span style="display:block;" id="fig:shapes"></span>
<img src="working-in-R-bookdown_files/figure-html/shapes-1.png" alt="Shapes" width="672"><p class="caption">
Figure 14.6: Shapes
</p>
</div>
<p>Shapes 21-24 take a <code>fill</code> and a <code>colour</code> aesthetic, whereas all the other shapes just take <code>colour</code>.</p>
<p>If you want to change the shape from the default shapes, use <code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_shape_manual()</a></code>.</p>
<div class="sourceCode" id="cb513"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, 
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">body_mass_g</span>, y <span class="op">=</span> <span class="va">bill_length_mm</span>, colour <span class="op">=</span> <span class="va">species</span>, shape <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>Adelie <span class="op">=</span> <span class="fl">17</span>, Chinstrap <span class="op">=</span> <span class="fl">6</span>, Gentoo <span class="op">=</span> <span class="fl">16</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="working-in-R-bookdown_files/figure-html/scale-shape-manual-1.png" width="336"></div>
</div>
<div id="linetypes" class="section level2" number="14.3">
<h2>
<span class="header-section-number">14.3</span> linetypes<a class="anchor" aria-label="anchor" href="#linetypes"><i class="fas fa-link"></i></a>
</h2>
<p>You can change the line types of all the lines made by, for example, <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code> by setting the linetype.</p>
<div class="sourceCode" id="cb514"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">ChickWeight</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">weight</span>, group <span class="op">=</span> <span class="va">Chick</span>, colour <span class="op">=</span> <span class="va">Diet</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="working-in-R-bookdown_files/figure-html/chickweight-1.png" width="336"></div>
<p>If you map a discrete variable to the <code>linetype</code> aesthetic, lines made by <code>geom_line</code>, <code>geom_path</code>, etc will have different line types or the different values in the variable.
Line types can sometimes be used in addition to colour to make it easier to differentiate lines.</p>
<div class="sourceCode" id="cb515"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">ChickWeight</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">weight</span>, group <span class="op">=</span> <span class="va">Chick</span>, colour <span class="op">=</span> <span class="va">Diet</span>, linetype <span class="op">=</span> <span class="va">Diet</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="working-in-R-bookdown_files/figure-html/chickweight2-1.png" width="336"></div>
<p>If you need to change the linetypes assigned to each value, you can use <code>scale_linetype_manual</code> and specify them by name (Fig. <a href="shapes-colours-and-linetypes.html#fig:linetypes">14.7</a>).</p>
<div class="figure">
<span style="display:block;" id="fig:linetypes"></span>
<img src="working-in-R-bookdown_files/figure-html/linetypes-1.png" alt="Some named linetypes" width="288"><p class="caption">
Figure 14.7: Some named linetypes
</p>
</div>
<p>Custom linetypes can also be made using of up to eight hexadecimal digits (1-9, A-F) that give the length of lines and gaps.
<code>"1FFF"</code> would draw a dot followed by a long gap, a long line, and another long gap, and then the pattern would repeat.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="themes-1.html"><span class="header-section-number">13</span> Themes</a></div>
<div class="next"><a href="combining-plots.html"><span class="header-section-number">15</span> Combining plots</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#shapes-colours-and-linetypes"><span class="header-section-number">14</span> Shapes, colours and linetypes</a></li>
<li>
<a class="nav-link" href="#colours-and-fill"><span class="header-section-number">14.1</span> Colours and fill</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#discrete-colourfill-scales"><span class="header-section-number">14.1.1</span> Discrete colour/fill scales</a></li>
<li><a class="nav-link" href="#qualitative"><span class="header-section-number">14.1.2</span> Qualitative</a></li>
<li><a class="nav-link" href="#sequential"><span class="header-section-number">14.1.3</span> Sequential</a></li>
<li><a class="nav-link" href="#diverging"><span class="header-section-number">14.1.4</span> Diverging</a></li>
<li><a class="nav-link" href="#continuous-colourfill-scales"><span class="header-section-number">14.1.5</span> Continuous colour/fill scales</a></li>
<li><a class="nav-link" href="#colour-blind-friendly-colours"><span class="header-section-number">14.1.6</span> Colour blind friendly colours</a></li>
</ul>
</li>
<li><a class="nav-link" href="#shapes"><span class="header-section-number">14.2</span> Shapes</a></li>
<li><a class="nav-link" href="#linetypes"><span class="header-section-number">14.3</span> linetypes</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Working in R</strong>" was written by Jonathan Soulé, Aud Halbritter and Richard J Telford. It was last built on 2021-09-07.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
