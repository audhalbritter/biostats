<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>4 Importing data in R | Working in R</title>
<meta name="author" content="Jonathan Soulé, Aud Halbritter and Richard J Telford">
<meta name="description" content="R can import data from files in many different formats. For example: csv files with the readr package excel files with the readxl package xlm files with the xml2 package netcdf files with the...">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="4 Importing data in R | Working in R">
<meta property="og:type" content="book">
<meta property="og:description" content="R can import data from files in many different formats. For example: csv files with the readr package excel files with the readxl package xlm files with the xml2 package netcdf files with the...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="4 Importing data in R | Working in R">
<meta name="twitter:description" content="R can import data from files in many different formats. For example: csv files with the readr package excel files with the readxl package xlm files with the xml2 package netcdf files with the...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/panelset-0.2.6/panelset.css" rel="stylesheet">
<script src="libs/panelset-0.2.6/panelset.js"></script><link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="css/style-chapters.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Working in R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Introduction</a></li>
<li class="book-part">Setting up R and RStudio</li>
<li><a class="" href="getting-started-with-r.html"><span class="header-section-number">2</span> Getting started with R</a></li>
<li class="book-part">First steps in R</li>
<li><a class="" href="first-steps-in-r.html"><span class="header-section-number">3</span> First steps in R</a></li>
<li><a class="active" href="importing-data-in-r.html"><span class="header-section-number">4</span> Importing data in R</a></li>
<li class="book-part">Data manipulation with the tidyverse</li>
<li><a class="" href="pipes.html"><span class="header-section-number">5</span> Pipes</a></li>
<li><a class="" href="tidying-data-with-tidyr.html"><span class="header-section-number">6</span> Tidying data with tidyr</a></li>
<li><a class="" href="working-with-single-tables-in-dplyr.html"><span class="header-section-number">7</span> Working with single tables in dplyr</a></li>
<li><a class="" href="working-with-multiple-tables-in-dplyr.html"><span class="header-section-number">8</span> Working with multiple tables in dplyr</a></li>
<li class="book-part">Data visualisation</li>
<li><a class="" href="why-is-data-visualization-important.html"><span class="header-section-number">10</span> Why is data visualization important?</a></li>
<li><a class="" href="getting-started-with-ggplot.html"><span class="header-section-number">11</span> Getting started with ggplot</a></li>
<li><a class="" href="types-of-vizualization.html"><span class="header-section-number">12</span> Types of vizualization</a></li>
<li><a class="" href="themes-1.html"><span class="header-section-number">13</span> Themes</a></li>
<li><a class="" href="shapes-colours-and-linetypes.html"><span class="header-section-number">14</span> Shapes, colours and linetypes</a></li>
<li><a class="" href="combining-plots.html"><span class="header-section-number">15</span> Combining plots</a></li>
<li><a class="" href="using-functions-and-packages.html"><span class="header-section-number">16</span> Using functions and packages</a></li>
<li class="book-part">Other topics</li>
<li><a class="" href="handling-missing-values.html"><span class="header-section-number">17</span> Handling missing values</a></li>
<li><a class="" href="bestiary-of-brackets-and-other-r-notation.html"><span class="header-section-number">18</span> Bestiary of Brackets and other R notation</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="importing-data-in-r" class="section level1" number="4">
<h1>
<span class="header-section-number">4</span> Importing data in R<a class="anchor" aria-label="anchor" href="#importing-data-in-r"><i class="fas fa-link"></i></a>
</h1>
<p>R can import data from files in many different formats.
For example:</p>
<ul>
<li>csv files with the <code>readr</code> package</li>
<li>excel files with the <code>readxl</code> package</li>
<li>xlm files with the <code>xml2</code> package</li>
<li>netcdf files with the <code>ncdf4</code> package</li>
<li>shapefiles with the <code>sf</code> package</li>
</ul>
<p>In this chapter, you will learn how to import tabular data from an external text file as a tibble.
We will use functions from the package <code>readr</code> which is part of the <code>tidyverse</code> package, so make sure that you have activated it with <code><a href="https://tidyverse.tidyverse.org">library(tidyverse)</a></code>.</p>
<div id="before-we-start-2" class="section level3 unnumbered facta toc-ignore">
<h3>Before we start<a class="anchor" aria-label="anchor" href="#before-we-start-2"><i class="fas fa-link"></i></a>
</h3>
<p>You must be familiar with tibbles and data types (such as numeric, character, etc).</p>
</div>
<div id="what-are-tabular-data" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> What are tabular data?<a class="anchor" aria-label="anchor" href="#what-are-tabular-data"><i class="fas fa-link"></i></a>
</h2>
<p>Tabular data are data that is organized in the form of a table with rows and columns.
A table often has a header, i.e. an additional row that displays variable names.
Here is an example of a formatted table with header:</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:kable">Table 4.1: </span><em>A simple table with header</em>
</caption>
<thead><tr class="header">
<th align="left">month</th>
<th align="right">temperature (Celsius)</th>
<th align="right">precipitation (mm)</th>
<th align="right">Wind (m/s)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">January</td>
<td align="right">-3.4</td>
<td align="right">29.4</td>
<td align="right">1.3</td>
</tr>
<tr class="even">
<td align="left">February</td>
<td align="right">-0.4</td>
<td align="right">15.4</td>
<td align="right">0.9</td>
</tr>
<tr class="odd">
<td align="left">March</td>
<td align="right">-1.7</td>
<td align="right">57.6</td>
<td align="right">1.7</td>
</tr>
<tr class="even">
<td align="left">april</td>
<td align="right">3.8</td>
<td align="right">3.2</td>
<td align="right">0.8</td>
</tr>
<tr class="odd">
<td align="left">May</td>
<td align="right">5.1</td>
<td align="right">25.2</td>
<td align="right">1.4</td>
</tr>
<tr class="even">
<td align="left">June</td>
<td align="right">10.6</td>
<td align="right">52.4</td>
<td align="right">1.1</td>
</tr>
<tr class="odd">
<td align="left">July</td>
<td align="right">13.1</td>
<td align="right">65.0</td>
<td align="right">1.0</td>
</tr>
<tr class="even">
<td align="left">August</td>
<td align="right">12.8</td>
<td align="right">67.4</td>
<td align="right">0.7</td>
</tr>
<tr class="odd">
<td align="left">September</td>
<td align="right">6.9</td>
<td align="right">79.0</td>
<td align="right">1.2</td>
</tr>
<tr class="even">
<td align="left">October</td>
<td align="right">2.5</td>
<td align="right">18.2</td>
<td align="right">0.8</td>
</tr>
<tr class="odd">
<td align="left">November</td>
<td align="right">-2.2</td>
<td align="right">7.8</td>
<td align="right">0.8</td>
</tr>
<tr class="even">
<td align="left">December</td>
<td align="right">1.5</td>
<td align="right">92.0</td>
<td align="right">1.5</td>
</tr>
</tbody>
</table></div>
<p>In this example, the table consists of 4 variables (columns) and 12 observations (rows) in addition to the header (top row).
All cell contents are clearly delimited.</p>
<p>Below is an example of a <em>non</em>-tabular dataset.
This dataset is a list of profiles with recurrent fields (<code>Name</code>, <code>Position</code>, <code>Institution</code>).
Each profile contains three lines with a <code>field:value</code> pair.</p>
<pre><code>## Name: Aud Halbritter
## Position: Researcher
## Institution: UiB
## -----------------------------
## Name: Jonathan Soule
## Position: Senior Engineer
## Institution: UiB
## -----------------------------
## Name: Richard J. Telford
## Position: Associate Professor
## Institution: UiB
## -----------------------------</code></pre>
</div>
<div id="about-tidy-data" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> About tidy data<a class="anchor" aria-label="anchor" href="#about-tidy-data"><i class="fas fa-link"></i></a>
</h2>
<p>Sooner or later, you will read about <em>tidy data</em> which is a standard, consistent way to organize tabular data in R.
Briefly, tidy data follows a short series of rules:</p>
<ul>
<li>each variable in the data set is presented in a specific column,</li>
<li>each observation in the data set is presented in a specific row,</li>
<li>each cell at the intersection of a row and a column contains a single value.</li>
</ul>
<p>The following figure illustrates well these rules.</p>
<div class="figure">
<span style="display:block;" id="fig:threerules"></span>
<img src="Pics/tidy1.png" alt="_In a tidy dataset, variables are in columns, observations are in rows, and values are in cells._ --- Source: [R for Data Science](https://r4ds.had.co.nz/tidy-data.html) - [CC BY-NC-ND 3.0 US](https://creativecommons.org/licenses/by-nc-nd/3.0/us/)" width="100%"><p class="caption">
Figure 4.1: <em>In a tidy dataset, variables are in columns, observations are in rows, and values are in cells.</em> — Source: <a href="https://r4ds.had.co.nz/tidy-data.html">R for Data Science</a> - <a href="https://creativecommons.org/licenses/by-nc-nd/3.0/us/">CC BY-NC-ND 3.0 US</a>
</p>
</div>
<p>The dataset presented in Table <a href="importing-data-in-r.html#tab:kable">4.1</a> respects all three rules, and is thus a tidy dataset.</p>
On the contrary, the following dataset is <em>not</em> tidy:
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Date"],"name":[1],"type":["chr"],"align":["left"]},{"label":["17.06.2016"],"name":[2],"type":["chr"],"align":["left"]},{"label":["21.06.2016"],"name":[3],"type":["chr"],"align":["left"]},{"label":["23.06.2016"],"name":[4],"type":["chr"],"align":["left"]},{"label":["26.06.2016"],"name":[5],"type":["chr"],"align":["left"]},{"label":["27.06.2016"],"name":[6],"type":["chr"],"align":["left"]},{"label":["28.06.2016"],"name":[7],"type":["chr"],"align":["left"]},{"label":["29.06.2016"],"name":[8],"type":["chr"],"align":["left"]},{"label":["30.06.2016"],"name":[9],"type":["chr"],"align":["left"]},{"label":["02.07.2016"],"name":[10],"type":["chr"],"align":["left"]},{"label":["04.07.2016"],"name":[11],"type":["chr"],"align":["left"]},{"label":["05.07.2016"],"name":[12],"type":["chr"],"align":["left"]},{"label":["06.07.2016"],"name":[13],"type":["chr"],"align":["left"]},{"label":["08.07.2016"],"name":[14],"type":["chr"],"align":["left"]},{"label":["10.07.2016"],"name":[15],"type":["chr"],"align":["left"]},{"label":["11.07.2016"],"name":[16],"type":["chr"],"align":["left"]},{"label":["13.07.2016"],"name":[17],"type":["chr"],"align":["left"]},{"label":["15.07.2016"],"name":[18],"type":["chr"],"align":["left"]},{"label":["17.07.2016"],"name":[19],"type":["chr"],"align":["left"]},{"label":["19.07.2016"],"name":[20],"type":["chr"],"align":["left"]},{"label":["21.07.2016"],"name":[21],"type":["chr"],"align":["left"]},{"label":["23.07.2016"],"name":[22],"type":["chr"],"align":["left"]},{"label":["24.07.2016"],"name":[23],"type":["chr"],"align":["left"]},{"label":["26.07.2016"],"name":[24],"type":["chr"],"align":["left"]},{"label":["28.07.2016"],"name":[25],"type":["chr"],"align":["left"]},{"label":["30.07.2016"],"name":[26],"type":["chr"],"align":["left"]},{"label":["02.08.2016"],"name":[27],"type":["chr"],"align":["left"]},{"label":["04.08.2016"],"name":[28],"type":["chr"],"align":["left"]},{"label":["06.08.2016"],"name":[29],"type":["chr"],"align":["left"]},{"label":["11.08.2016"],"name":[30],"type":["chr"],"align":["left"]},{"label":["13.08.2016"],"name":[31],"type":["chr"],"align":["left"]},{"label":["15.08.2016"],"name":[32],"type":["chr"],"align":["left"]},{"label":["17.08.2016"],"name":[33],"type":["chr"],"align":["left"]},{"label":["18.08.2016"],"name":[34],"type":["chr"],"align":["left"]}],"data":[{"1":"Time","2":"10:00","3":"11:00","4":"11:00","5":"13:00","6":"13:00","7":"09:33","8":"13:00","9":"15:00","10":"09:00","11":"09:15","12":"09:30","13":"09:15","14":"09:15","15":"09:15","16":"09:15","17":"09:30","18":"10:00","19":"13:00","20":"17:30","21":"10.00","22":"10:00","23":"09:30","24":"09:30","25":"09:30","26":"09:15","27":"09:30","28":"15:00","29":"11:00","30":"15:00","31":"14:00","32":"09:00","33":"11:00","34":"08:00"},{"1":"Weather","2":"Sunny_PartlyCloudy","3":"Cloudy_Fog","4":"Cloudy_Sunny","5":"Cloudy_Rainy_Windy_Fog","6":"Cloudy_Windy_Rainy","7":"Windy_Rainy_MostlyCloudy","8":"Windy_Sunny_Cloudy","9":"Windy_Cloudy","10":"Windy_Cloudy","11":"Cloudy_Sunny","12":"Cloudy_Sunny","13":"Cloudy_Fog_Rainy","14":"Sunny_PartlyCloudy","15":"Cloudy_Rainy","16":"Cloudy","17":"Cloudy_Sunny","18":"Cloudy","19":"Cloudy_Rainy","20":"Cloudy_Rainy","21":"Cloudy_Sunny","22":"Sunny_Cloudy","23":"Cloudy_Sunny","24":"Cloudy_Rainy","25":"Cloudy_Rainy","26":"Cloudy_Rainy","27":"Cloudy_Rainy","28":"Cloudy_Rainy","29":"Cloudy_Rainyn","30":"Cloudy_Snowy_Sunny","31":"Cloudy_PartlyRainy","32":"Cloudy_Sunny","33":"Sunny","34":"Cloudy;Cloudy"},{"1":"Observer","2":"LV_AH","3":"LV","4":"LV","5":"LV","6":"LV_SB","7":"LV_SB","8":"LV_SB","9":"LV","10":"LV_SB","11":"SB_LV","12":"SB_LV","13":"LV_SB","14":"LV_SB","15":"LV_SB","16":"LV","17":"LV","18":"LV_SB_AH","19":"SB_LV","20":"SB_LV","21":"SB_LV","22":"SB_LV","23":"LV","24":"LV","25":"LV","26":"LV","27":"LV","28":"LV","29":"LV","30":"LV","31":"LV","32":"LV","33":"LV","34":"LV"},{"1":"E01a","2":"0","3":"NA","4":"0","5":"0","6":"0","7":"0","8":"1","9":"1","10":"2","11":"2","12":"3","13":"3","14":"6","15":"8","16":"8","17":"11","18":"13","19":"10","20":"9","21":"7","22":"3","23":"6","24":"3","25":"3","26":"1","27":"1","28":"1","29":"2","30":"1","31":"NA","32":"NA","33":"NA","34":"NA"},{"1":"E01b","2":"0","3":"NA","4":"0","5":"0","6":"1","7":"1","8":"1","9":"1","10":"1","11":"1","12":"1","13":"1","14":"3","15":"3","16":"3","17":"8","18":"19","19":"23","20":"26","21":"24","22":"16","23":"16","24":"8","25":"5","26":"2","27":"3","28":"4","29":"3","30":"2","31":"NA","32":"NA","33":"NA","34":"NA"},{"1":"E01c","2":"0","3":"NA","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"1","17":"5","18":"9","19":"12","20":"10","21":"7","22":"4","23":"3","24":"3","25":"3","26":"2","27":"2","28":"0","29":"1","30":"1","31":"NA","32":"NA","33":"NA","34":"NA"},{"1":"E01d","2":"0","3":"NA","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"1","15":"1","16":"1","17":"2","18":"4","19":"3","20":"2","21":"4","22":"1","23":"1","24":"1","25":"2","26":"2","27":"1","28":"1","29":"1","30":"0","31":"NA","32":"NA","33":"NA","34":"NA"},{"1":"E01e","2":"0","3":"NA","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"1","18":"4","19":"4","20":"4","21":"5","22":"4","23":"3","24":"1","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"NA","32":"NA","33":"NA","34":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Indeed, at least one of the rules is broken since columns display data matching several variables (Date, time, Weather, etc).</p>
<p>Importing data from a file containing tidy data is a great way to start your work, but it is <em>not</em> a prerequisite to data import.
As long as your data is tabular, you will be able to import it in R, and later you will have the chance to tidy it (see chapter <a href="tidying-data-with-tidyr.html#tidying-data-with-tidyr">6</a>).</p>
</div>
<div id="file-formats" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> File formats<a class="anchor" aria-label="anchor" href="#file-formats"><i class="fas fa-link"></i></a>
</h2>
<p>Tabular data may be stored in files using various formats, spreadsheets, etc.
The most common spreadsheets store data in their own, proprietary file format, e.g. MS Excel which produces <code>.xls</code> and <code>.xlsx</code> files.
Such formats may be a limitation to data management in R.
Simpler formats such as plain text files with <code>.txt</code> or <code>.csv</code> should always be preferred when saving or exporting data from spreadsheets.</p>
<div id="the-csv-format" class="section level3" number="4.3.1">
<h3>
<span class="header-section-number">4.3.1</span> The CSV format<a class="anchor" aria-label="anchor" href="#the-csv-format"><i class="fas fa-link"></i></a>
</h3>
<p>One of the most common format for storing tabular data in plain text files is CSV, which stands for <strong>C</strong>omma-<strong>S</strong>eparated <strong>V</strong>alues.
It is this format that we are going to deal with here.
Note that CSV-formatted files often have (but not always) a <code>.csv</code> extension. They may also have a regular <code>.txt</code> extension.</p>
<p>In a CSV-formatted file, the data is stored in a similar manner to this:</p>
<div class="figure">
<span style="display:block;" id="fig:csv-data"></span>
<img src="Pics/csv.png" alt="_Contents of a CSV file viewed in the text editor Notepad_" width="75%"><p class="caption">
Figure 4.2: <em>Contents of a CSV file viewed in the text editor Notepad</em>
</p>
</div>
<p>For information, this file matches the example in Table <a href="importing-data-in-r.html#tab:kable">4.1</a>.
Each line corresponds to a row in the table (including header) and cell contents are separated with a comma <code>,</code>.
Note that the period symbol <code>.</code> is used as decimal separator.</p>
<p>The use of commas in the CSV format is however not universal.
Other symbols such as a semi-colon <code>;</code> may be used as a delimiter.
This is the case in several European countries where commas are decimal separator.
Here is the same data set as above, this time in the European format:</p>
<div class="figure">
<span style="display:block;" id="fig:csv2-data"></span>
<img src="Pics/csv2.png" alt="_Contents of another CSV file_" width="75%"><p class="caption">
Figure 4.3: <em>Contents of another CSV file</em>
</p>
</div>
<p>Finally, you should know that there exist other delimiter-separated formats, in which delimiters like <code><a href="https://rdrr.io/r/base/Logic.html">|</a></code> or tabs (coded as <code>\t</code>) replace commas.</p>
</div>
</div>
<div id="know-your-data" class="section level2" number="4.4">
<h2>
<span class="header-section-number">4.4</span> Know your data!<a class="anchor" aria-label="anchor" href="#know-your-data"><i class="fas fa-link"></i></a>
</h2>
<p>There are several reasons why different symbols are used in CSV files.
Among these reasons are:</p>
<ul>
<li>locale, i.e. the parameters that define the language and regional settings (currency, time and date, number format setting) in use on your machine,</li>
<li>software-based preferences, the settings which are defined <em>by default</em> by the software that you have used to punch your data,</li>
<li>user-based preferences, the settings that <em>you</em> choose when punching or saving data.</li>
</ul>
<p>It is thus very important to know what your CSV file is made of.
We therefore recommend to systematically inspect your data file before importing in R.
One way to do it is to open the file with <code>read_lines('file.txt')</code> (the <code>n_max</code> argument is useful if there is lots of data) and determine:</p>
<ul>
<li>which symbol is used as decimal separator (<code>,</code> or <code>.</code>)</li>
<li>which symbol is used as delimiter (<code>,</code> or <code>;</code>)</li>
<li>any extra lines of data that need removing</li>
</ul>
<p>Here is our previous example:</p>
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">read_lines</span><span class="op">(</span><span class="st">'data/weather.csv'</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "month,temperature (Celsius),precipitation (mm),Wind (m/s)"
##  [2] "January,-3.4,29.4,1.3"                                    
##  [3] "February,-0.4,15.4,0.9"                                   
##  [4] "March,-1.7,57.6,1.7"                                      
##  [5] "april,3.8,3.2,0.8"                                        
##  [6] "May,5.1,25.2,1.4"                                         
##  [7] "June,10.6,52.4,1.1"                                       
##  [8] "July,13.1,65.0,1.0"                                       
##  [9] "August,12.8,67.4,0.7"                                     
## [10] "September,6.9,79.0,1.2"                                   
## [11] "October,2.5,18.2,0.8"                                     
## [12] "November,-2.2,7.8,0.8"                                    
## [13] "December,1.5,92.0,1.5"</code></pre>
<p>In this file, the decimal separator is <code>.</code> and the delimiter is <code>,</code>.</p>
</div>
<div id="import-with-readr" class="section level2" number="4.5">
<h2>
<span class="header-section-number">4.5</span> Import with readr<a class="anchor" aria-label="anchor" href="#import-with-readr"><i class="fas fa-link"></i></a>
</h2>
<p><code>readr</code> comes with several functions that read data files.
Among them are:</p>
<ul>
<li>
<code>read_delim()</code>,</li>
<li>
<code>read_csv()</code>,</li>
<li>
<code>read_csv2()</code>.</li>
</ul>
<p>We will focus essentially on <code>read_delim()</code> as it is a general function that can import all the formats.
<code>read_csv()</code> and <code>read_csv2()</code> are more specific functions which are preset to import CSV-formatted files in which a comma <code>,</code> or a semi-colon <code>;</code> is defined as delimiter, respectively.</p>
<div id="read_delim" class="section level3" number="4.5.1">
<h3>
<span class="header-section-number">4.5.1</span> read_delim()<a class="anchor" aria-label="anchor" href="#read_delim"><i class="fas fa-link"></i></a>
</h3>
<p><code>read_delim()</code> is a simple function that does several things at once.
First, it finds and reads the file to import.
Then it looks at the first 1000 rows of the file and guesses the number of variables and rows, and the data type for each variable.
Finally, it displays the data as a tibble keeping track of the order of both the columns and rows, and the nature of the data.</p>
<p>The function does not automatically <em>store</em> the data after reading the file.
This is why the tibble produced by <code>read_delim()</code> must be assigned to an object using <code><a href="https://rdrr.io/r/base/assignOps.html">&lt;-</a></code>.</p>
<p><code>read_delim()</code> has two main mandatory arguments:</p>
<ul>
<li>
<code>file = " "</code> which defines where to find the data file,</li>
<li>
<code>delim = " "</code> which defines the symbol used as delimiter.</li>
</ul>
<p>When searching for the file, R/RStudio uses the location of the current RStudio project as a root.
As a consequence, you may simply write the file name if the file is in the same folder as your <code>.Rproj</code> file.
Alternatively, write <code>[subfolder]/[filename]</code> if the file is in a subfolder.
For more info about RStudio projects, read section <a href="getting-started-with-r.html#working-with-a-project">2.4</a>.</p>
<p>In the following example, we import the file <code>weather.csv</code> located in the subfolder <code>data</code> of the current RStudio project into the object <code>weather</code>.
In <code>weather.csv</code>, the delimiter is <code>,</code> and the decimal separator is <code>.</code></p>
<div class="sourceCode" id="cb179"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weather</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/weather.csv"</span>, 
                      delim <span class="op">=</span> <span class="st">","</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 12 Columns: 4</code></pre>
<pre><code>## ── Column specification ──────────────────────────────────────
## Delimiter: ","
## chr (1): month
## dbl (3): temperature (Celsius), precipitation (mm), Wind (...</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>When the function is executed, the console shows a short series of warnings and messages.
In the frame above, the message <code>Column specification</code> tells you that the content of the column <code>month</code> has been recognized as of data type <code>character</code>, and that the three other columns have been recognized as <code>double</code> (which is similar to <code>numeric</code>).</p>
<p>Now the tibble <code>weather</code> is available in R as you may see in the tab <code>Environment</code> (see figure <a href="importing-data-in-r.html#fig:csv-env">4.4</a>).</p>
<div class="figure">
<span style="display:block;" id="fig:csv-env"></span>
<img src="Pics/csv-env.png" alt="_The tibble_ weather _is now stored in R._" width="100%"><p class="caption">
Figure 4.4: <em>The tibble</em> weather <em>is now stored in R.</em>
</p>
</div>
<p>You can display the table as follows:</p>
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weather</span></code></pre></div>
<pre><code>## # A tibble: 12 × 4
##    month     `temperature (Cel… `precipitation (… `Wind (m/s)`
##    &lt;chr&gt;                  &lt;dbl&gt;             &lt;dbl&gt;        &lt;dbl&gt;
##  1 January                 -3.4              29.4          1.3
##  2 February                -0.4              15.4          0.9
##  3 March                   -1.7              57.6          1.7
##  4 april                    3.8               3.2          0.8
##  5 May                      5.1              25.2          1.4
##  6 June                    10.6              52.4          1.1
##  7 July                    13.1              65            1  
##  8 August                  12.8              67.4          0.7
##  9 September                6.9              79            1.2
## 10 October                  2.5              18.2          0.8
## 11 November                -2.2               7.8          0.8
## 12 December                 1.5              92            1.5</code></pre>
<div id="choose-the-right-delimiter" class="section level4" number="4.5.1.1">
<h4>
<span class="header-section-number">4.5.1.1</span> Choose the right delimiter<a class="anchor" aria-label="anchor" href="#choose-the-right-delimiter"><i class="fas fa-link"></i></a>
</h4>
<p>The example above is rather straight forward, but you may experience some issues depending on the content of the CSV file.
Relatively often, one tries to import CSV files wrongly assuming that <code>,</code> has been used as a delimiter.
Here is what happens when doing this assumption for a file (<code>weather2.csv</code>) where <code>;</code> was in fact used as delimiter:</p>
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weather2</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/weather2.csv"</span>, 
                       delim <span class="op">=</span> <span class="st">","</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 12 Columns: 1</code></pre>
<pre><code>## ── Column specification ──────────────────────────────────────
## Delimiter: ","
## chr (1): month;temperature (Celsius);precipitation (mm);Wi...</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>The message <code>Column specification</code> tells you that the content of the whole CSV file has been transferred into one single column named <code>month;temperature (Celsius);precipitation (mm);Wind (m/s)</code> and recognized as of data type <code>character</code>.
Accordingly, the object <code>weather2</code>, now visible in the tab <code>Environment</code> (see figure <a href="importing-data-in-r.html#fig:csv-env2">4.5</a>), is described as a tibble with 12 observations and only one variable.</p>
<div class="figure">
<span style="display:block;" id="fig:csv-env2"></span>
<img src="Pics/csv-env2.png" alt="_The tibble_ weather2 _is now stored, but is wrongly formatted._" width="100%"><p class="caption">
Figure 4.5: <em>The tibble</em> weather2 <em>is now stored, but is wrongly formatted.</em>
</p>
</div>
<p>The content of the resulting tibble is as follows:</p>
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weather2</span></code></pre></div>
<pre><code>## # A tibble: 12 × 1
##    `month;temperature (Celsius);precipitation (mm);Wind (m/s)`
##    &lt;chr&gt;                                                      
##  1 January;-3,4;29,4;1,3                                      
##  2 February;-0,4;15,4;0,9                                     
##  3 March;-1,7;57,6;1,7                                        
##  4 april;3,8;3,2;0,8                                          
##  5 May;5,1;25,2;1,4                                           
##  6 June;10,6;52,4;1,1                                         
##  7 July;13,1;65,0;1,0                                         
##  8 August;12,8;67,4;0,7                                       
##  9 September;6,9;79,0;1,2                                     
## 10 October;2,5;18,2;0,8                                       
## 11 November;-2,2;7,8;0,8                                      
## 12 December;1,5;92,0;1,5</code></pre>
<p>This shows how important it is to review the data before importing it.
A quick check with <code>read_lines('data/weather2.csv')</code> would have revealed the use of <code>;</code> as delimiter in <code>weather2.csv</code>, and you would have certainly used the follow code to import it.</p>
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weather2</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/weather2.csv"</span>, 
                       delim <span class="op">=</span> <span class="st">";"</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 12 Columns: 4</code></pre>
<pre><code>## ── Column specification ──────────────────────────────────────
## Delimiter: ";"
## chr (2): month, Wind (m/s)</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>Here, the message <code>Column specification</code> tells you that the content of the columns <code>month</code> and <code>Wind (m/s)</code> has been recognized as of data type <code>character</code>, and that the two other columns have been recognized as <code>number</code>.
While <code>read_delim()</code> got things right about the number of variables, something went wrong with the variables as we could expect <code>Wind (m/s)</code> to be recognized as <code>double</code>.
To find out about this issue we need to review the imported data in the object <code>weather2</code> and compare it to the original file <code>weather2.csv</code>.</p>
</div>
<div id="review-the-imported-data" class="section level4" number="4.5.1.2">
<h4>
<span class="header-section-number">4.5.1.2</span> Review the imported data<a class="anchor" aria-label="anchor" href="#review-the-imported-data"><i class="fas fa-link"></i></a>
</h4>
<p>The example above shows the importance of carefully verifying that the imported data in R matches the original data set.
The following figure compares the content of the file <code>weather2.csv</code> (Fig. <a href="importing-data-in-r.html#fig:comp-fig">4.6</a> left) to the content of the object <code>weather2</code> (Fig. <a href="importing-data-in-r.html#fig:comp-fig">4.6</a> right):</p>
<div class="figure">
<span style="display:block;" id="fig:comp-fig"></span>
<img src="Pics/comp.png" alt="_The data in the object does not match the data in the file._" width="100%"><p class="caption">
Figure 4.6: <em>The data in the object does not match the data in the file.</em>
</p>
</div>
<p>Looking at the rows in both pictures, one can understand that all commas have simply been ignored, excepted those in the last column.
This is a problem that may occur when the decimal separator used in the file is different from the decimal separator defined by your system (a.k.a locale).
To solve that issue, you must impose the separator using <code>locale = locale(decimal_mark = ",")</code>:</p>
<div class="sourceCode" id="cb195"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weather3</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/weather2.csv"</span>, 
                       delim <span class="op">=</span> <span class="st">";"</span>, 
                       locale <span class="op">=</span> <span class="fu"><a href="https://vroom.r-lib.org/reference/locale.html">locale</a></span><span class="op">(</span>decimal_mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 12 Columns: 4</code></pre>
<pre><code>## ── Column specification ──────────────────────────────────────
## Delimiter: ";"
## chr (1): month
## dbl (3): temperature (Celsius), precipitation (mm), Wind (...</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
The last column is now recognized as <code>double</code> and the data in the object <code>weather3</code> matches the data in the file:
<div class="figure">
<span style="display:block;" id="fig:comp2"></span>
<img src="Pics/comp2.png" alt="_The data in the object now matches the data in the file._" width="100%"><p class="caption">
Figure 4.7: <em>The data in the object now matches the data in the file.</em>
</p>
</div>
</div>
</div>
<div id="read_csv" class="section level3" number="4.5.2">
<h3>
<span class="header-section-number">4.5.2</span> read_csv()<a class="anchor" aria-label="anchor" href="#read_csv"><i class="fas fa-link"></i></a>
</h3>
<p>As we have seen in the section above, <code>read_delim()</code> can read CSV files where <code>,</code> and <code>;</code> are used as delimiters.
<code>readr</code> also comes with other functions such as <code>read_csv()</code> and its twin <code>read_csv2()</code>.
These are “clones” of <code>read_delim()</code> where the argument <code>delim =</code> is preset to <code>delim = ","</code> and <code>delim = ";"</code>, respectively.
Thus, the only argument that is strictly required is <code>file = " "</code> to determine the path of the file.</p>
<p>Here are two examples. The first one shows the use of <code>read_csv()</code>:</p>
<div class="sourceCode" id="cb199"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weather_csv</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/weather.csv"</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 12 Columns: 4</code></pre>
<pre><code>## ── Column specification ──────────────────────────────────────
## Delimiter: ","
## chr (1): month
## dbl (3): temperature (Celsius), precipitation (mm), Wind (...</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>The resulting tibble looks correct:</p>
<div class="sourceCode" id="cb203"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weather_csv</span></code></pre></div>
<pre><code>## # A tibble: 12 × 4
##    month     `temperature (Cel… `precipitation (… `Wind (m/s)`
##    &lt;chr&gt;                  &lt;dbl&gt;             &lt;dbl&gt;        &lt;dbl&gt;
##  1 January                 -3.4              29.4          1.3
##  2 February                -0.4              15.4          0.9
##  3 March                   -1.7              57.6          1.7
##  4 april                    3.8               3.2          0.8
##  5 May                      5.1              25.2          1.4
##  6 June                    10.6              52.4          1.1
##  7 July                    13.1              65            1  
##  8 August                  12.8              67.4          0.7
##  9 September                6.9              79            1.2
## 10 October                  2.5              18.2          0.8
## 11 November                -2.2               7.8          0.8
## 12 December                 1.5              92            1.5</code></pre>
<p>The second one shows the use of <code>read_csv2()</code>:</p>
<div class="sourceCode" id="cb205"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weather_csv2</span> <span class="op">&lt;-</span> <span class="fu">read_csv2</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/weather2.csv"</span><span class="op">)</span></code></pre></div>
<pre><code>## ℹ Using "','" as decimal and "'.'" as grouping mark. Use `read_delim()` for more control.</code></pre>
<pre><code>## Rows: 12 Columns: 4</code></pre>
<pre><code>## ── Column specification ──────────────────────────────────────
## Delimiter: ";"
## chr (1): month
## dbl (3): temperature (Celsius), precipitation (mm), Wind (...</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>Note the message above <code>Column specification</code> that indicates which symbols <code>read_csv2()</code> has considered when importing the data. The resulting tibble looks correct:</p>
<div class="sourceCode" id="cb210"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weather_csv2</span></code></pre></div>
<pre><code>## # A tibble: 12 × 4
##    month     `temperature (Cel… `precipitation (… `Wind (m/s)`
##    &lt;chr&gt;                  &lt;dbl&gt;             &lt;dbl&gt;        &lt;dbl&gt;
##  1 January                 -3.4              29.4          1.3
##  2 February                -0.4              15.4          0.9
##  3 March                   -1.7              57.6          1.7
##  4 april                    3.8               3.2          0.8
##  5 May                      5.1              25.2          1.4
##  6 June                    10.6              52.4          1.1
##  7 July                    13.1              65            1  
##  8 August                  12.8              67.4          0.7
##  9 September                6.9              79            1.2
## 10 October                  2.5              18.2          0.8
## 11 November                -2.2               7.8          0.8
## 12 December                 1.5              92            1.5</code></pre>
</div>
<div id="white-space-delimited-files" class="section level3" number="4.5.3">
<h3>
<span class="header-section-number">4.5.3</span> White space delimited files<a class="anchor" aria-label="anchor" href="#white-space-delimited-files"><i class="fas fa-link"></i></a>
</h3>
<p>Some files have white space separating the columns.
If a single tab is used then <code>read_delim()</code> will work with <code>delim = "\t"</code>.
Sometimes multiple spaces are used so the columns line up, making the text file easy for humans to read.
<code>read_delim()</code> will not work with these files as it expects a single delimiter.
Instead we can use <code>read_table()</code>.</p>
<div class="sourceCode" id="cb212"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">read_table</span><span class="op">(</span><span class="st">" Species   Value
            Navicula       1
            Cymbella       2"</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   Species  Value
##   &lt;chr&gt;    &lt;dbl&gt;
## 1 Navicula     1
## 2 Cymbella     2</code></pre>
<p>Another type of data you will sometimes see is the fixed width format.
There are no delimiters, but each field has the same position in each row.
These files can be imported with <code>read_fwf()</code>.
Determining the position of each column can be painful unless you have good metadata.</p>
</div>
<div id="exercise-19" class="section level3 unnumbered facta toc-ignore">
<h3>Exercise<a class="anchor" aria-label="anchor" href="#exercise-19"><i class="fas fa-link"></i></a>
</h3>
<p>Download the Mt Gonga <a href="https://raw.githubusercontent.com/biostats-r/biostats/main/WorkingInR/data/biomass2015_H.csv">plant biomass data</a> and import it.</p>
<details><summary>
Hint
</summary><code>read_delim</code>
</details>
</div>
<div id="useful-arguments" class="section level3" number="4.5.4">
<h3>
<span class="header-section-number">4.5.4</span> Useful arguments<a class="anchor" aria-label="anchor" href="#useful-arguments"><i class="fas fa-link"></i></a>
</h3>
<p><code>read_delim()</code> and the other functions discussed above have a multitude of arguments that allow for adjusting the way data is read and displayed.
Here we review a handful of them.</p>
<div id="n_max" class="section level4" number="4.5.4.1">
<h4>
<span class="header-section-number">4.5.4.1</span> n_max<a class="anchor" aria-label="anchor" href="#n_max"><i class="fas fa-link"></i></a>
</h4>
<p><code>n_max</code> sets a limit to the number of <em>observations</em> to be read.
Note that <code>n_max</code> does not consider the first row (header) of the data file as an observation.</p>
<div class="sourceCode" id="cb214"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weather</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/weather.csv"</span>, 
                      delim <span class="op">=</span> <span class="st">","</span>,
                      n_max <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 6 Columns: 4</code></pre>
<pre><code>## ── Column specification ──────────────────────────────────────
## Delimiter: ","
## chr (1): month
## dbl (3): temperature (Celsius), precipitation (mm), Wind (...</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb218"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weather</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   month    `temperature (Celsi… `precipitation (… `Wind (m/s)`
##   &lt;chr&gt;                   &lt;dbl&gt;             &lt;dbl&gt;        &lt;dbl&gt;
## 1 January                  -3.4              29.4          1.3
## 2 February                 -0.4              15.4          0.9
## 3 March                    -1.7              57.6          1.7
## 4 april                     3.8               3.2          0.8
## 5 May                       5.1              25.2          1.4
## 6 June                     10.6              52.4          1.1</code></pre>
</div>
<div id="skip" class="section level4" number="4.5.4.2">
<h4>
<span class="header-section-number">4.5.4.2</span> skip<a class="anchor" aria-label="anchor" href="#skip"><i class="fas fa-link"></i></a>
</h4>
<p>The argument <code>skip</code> may be used to skip rows when reading the data file.<br>
Be aware that:</p>
<ul>
<li>the header in the original data file counts as one row,</li>
<li>the first row that comes after those which have been skipped becomes the header for the resulting tibble.</li>
</ul>
<p>In the following example, we read the data file <code>weather.csv</code> and skip the first row:</p>
<div class="sourceCode" id="cb220"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weather</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/weather.csv"</span>, 
                      delim <span class="op">=</span> <span class="st">","</span>, 
                      skip <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 11 Columns: 4</code></pre>
<pre><code>## ── Column specification ──────────────────────────────────────
## Delimiter: ","
## chr (1): January
## dbl (3): -3.4, 29.4, 1.3</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb224"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weather</span></code></pre></div>
<pre><code>## # A tibble: 11 × 4
##    January   `-3.4` `29.4` `1.3`
##    &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
##  1 February    -0.4   15.4   0.9
##  2 March       -1.7   57.6   1.7
##  3 april        3.8    3.2   0.8
##  4 May          5.1   25.2   1.4
##  5 June        10.6   52.4   1.1
##  6 July        13.1   65     1  
##  7 August      12.8   67.4   0.7
##  8 September    6.9   79     1.2
##  9 October      2.5   18.2   0.8
## 10 November    -2.2    7.8   0.8
## 11 December     1.5   92     1.5</code></pre>
<p>As expected, the first row (with the header) is skipped, and the data from the observation <code>January</code> have become the header of the tibble.
The argument <code>col_names()</code> introduced below will be useful for solving this issue.</p>
</div>
<div id="col_names" class="section level4" number="4.5.4.3">
<h4>
<span class="header-section-number">4.5.4.3</span> col_names<a class="anchor" aria-label="anchor" href="#col_names"><i class="fas fa-link"></i></a>
</h4>
<p>The argument <code>col_names</code> may be used to define the name of the variables/columns of the tibble.
If you use <code>col_names = TRUE</code>, the first row of the data file defines the name of the variables.</p>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weather</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/weather.csv"</span>, 
                      delim <span class="op">=</span> <span class="st">","</span>, 
                      col_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 12 Columns: 4</code></pre>
<pre><code>## ── Column specification ──────────────────────────────────────
## Delimiter: ","
## chr (1): month
## dbl (3): temperature (Celsius), precipitation (mm), Wind (...</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb230"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weather</span></code></pre></div>
<pre><code>## # A tibble: 12 × 4
##    month     `temperature (Cel… `precipitation (… `Wind (m/s)`
##    &lt;chr&gt;                  &lt;dbl&gt;             &lt;dbl&gt;        &lt;dbl&gt;
##  1 January                 -3.4              29.4          1.3
##  2 February                -0.4              15.4          0.9
##  3 March                   -1.7              57.6          1.7
##  4 april                    3.8               3.2          0.8
##  5 May                      5.1              25.2          1.4
##  6 June                    10.6              52.4          1.1
##  7 July                    13.1              65            1  
##  8 August                  12.8              67.4          0.7
##  9 September                6.9              79            1.2
## 10 October                  2.5              18.2          0.8
## 11 November                -2.2               7.8          0.8
## 12 December                 1.5              92            1.5</code></pre>
<p>If you use <code>col_names = FALSE</code>, the first row of the data file will be the first observation in the resulting tibble, and the variables will be named <code>X1</code>, <code>X2</code>, etc.</p>
<div class="sourceCode" id="cb232"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weather</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/weather.csv"</span>, 
                      delim <span class="op">=</span> <span class="st">","</span>, 
                      col_names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 13 Columns: 4</code></pre>
<pre><code>## ── Column specification ──────────────────────────────────────
## Delimiter: ","
## chr (4): X1, X2, X3, X4</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb236"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weather</span></code></pre></div>
<pre><code>## # A tibble: 13 × 4
##    X1        X2                    X3                 X4      
##    &lt;chr&gt;     &lt;chr&gt;                 &lt;chr&gt;              &lt;chr&gt;   
##  1 month     temperature (Celsius) precipitation (mm) Wind (m…
##  2 January   -3.4                  29.4               1.3     
##  3 February  -0.4                  15.4               0.9     
##  4 March     -1.7                  57.6               1.7     
##  5 april     3.8                   3.2                0.8     
##  6 May       5.1                   25.2               1.4     
##  7 June      10.6                  52.4               1.1     
##  8 July      13.1                  65.0               1.0     
##  9 August    12.8                  67.4               0.7     
## 10 September 6.9                   79.0               1.2     
## 11 October   2.5                   18.2               0.8     
## 12 November  -2.2                  7.8                0.8     
## 13 December  1.5                   92.0               1.5</code></pre>
<p><code>col_names =</code> may also be followed by the actual variable names that you want to use.
In that case, write <code>col_names = c()</code> and list the names between the parentheses.
Be aware that:</p>
<ul>
<li>the names that you input will be placed on top of the tibble,</li>
<li>the header in the original data file will become the first row of the resulting tibble.
Here is an example:</li>
</ul>
<div class="sourceCode" id="cb238"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weather</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/weather.csv"</span>, 
                      delim <span class="op">=</span> <span class="st">","</span>, 
                      col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Month"</span>, <span class="st">"Temp"</span>, <span class="st">"Precip"</span>, <span class="st">"Wind"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 13 Columns: 4</code></pre>
<pre><code>## ── Column specification ──────────────────────────────────────
## Delimiter: ","
## chr (4): Month, Temp, Precip, Wind</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb242"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weather</span></code></pre></div>
<pre><code>## # A tibble: 13 × 4
##    Month     Temp                  Precip             Wind    
##    &lt;chr&gt;     &lt;chr&gt;                 &lt;chr&gt;              &lt;chr&gt;   
##  1 month     temperature (Celsius) precipitation (mm) Wind (m…
##  2 January   -3.4                  29.4               1.3     
##  3 February  -0.4                  15.4               0.9     
##  4 March     -1.7                  57.6               1.7     
##  5 april     3.8                   3.2                0.8     
##  6 May       5.1                   25.2               1.4     
##  7 June      10.6                  52.4               1.1     
##  8 July      13.1                  65.0               1.0     
##  9 August    12.8                  67.4               0.7     
## 10 September 6.9                   79.0               1.2     
## 11 October   2.5                   18.2               0.8     
## 12 November  -2.2                  7.8                0.8     
## 13 December  1.5                   92.0               1.5</code></pre>
</div>
<div id="col_types" class="section level4" number="4.5.4.4">
<h4>
<span class="header-section-number">4.5.4.4</span> col_types<a class="anchor" aria-label="anchor" href="#col_types"><i class="fas fa-link"></i></a>
</h4>
<p>The argument <code>col_types</code> may be used to modify the data type of the variables.
This is useful for example when you need to set a variable as <code>factor</code> whereas R has defined it as <code>character</code>.
Here is an example with three simple variables.</p>
<div class="sourceCode" id="cb244"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/groups.csv"</span>, 
                     delim <span class="op">=</span> <span class="st">","</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 9 Columns: 3</code></pre>
<pre><code>## ── Column specification ──────────────────────────────────────
## Delimiter: ","
## chr (1): group
## dbl (2): ID, count</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>As the message clearly indicates, the first and last variables are recognized as <code>double</code> (i.e. <code>numeric</code>) while the second one is recognized as <code>character</code>.
The tibble in the object <code>counts</code> displays as follows:</p>
<div class="sourceCode" id="cb248"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">counts</span></code></pre></div>
<pre><code>## # A tibble: 9 × 3
##      ID group count
##   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
## 1     1 A         5
## 2     2 A         3
## 3     3 A         2
## 4     4 B         4
## 5     5 B         5
## 6     6 B         8
## 7     7 C         1
## 8     8 C         2
## 9     9 C         9</code></pre>
<p>Let’s use <code>col_types = cols()</code> to manually set the data types to <code>double</code>, <code>factor</code> and <code>integer</code>, respectively.</p>
<div class="sourceCode" id="cb250"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/groups.csv"</span>, 
                     delim <span class="op">=</span> <span class="st">","</span>, 
                     col_types <span class="op">=</span> <span class="fu"><a href="https://vroom.r-lib.org/reference/cols.html">cols</a></span><span class="op">(</span><span class="fu"><a href="https://vroom.r-lib.org/reference/cols.html">col_double</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://vroom.r-lib.org/reference/cols.html">col_factor</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://vroom.r-lib.org/reference/cols.html">col_integer</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Now the tibble displays like this, with the correct data types for each column:</p>
<div class="sourceCode" id="cb251"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">counts</span></code></pre></div>
<pre><code>## # A tibble: 9 × 3
##      ID group count
##   &lt;dbl&gt; &lt;fct&gt; &lt;int&gt;
## 1     1 A         5
## 2     2 A         3
## 3     3 A         2
## 4     4 B         4
## 5     5 B         5
## 6     6 B         8
## 7     7 C         1
## 8     8 C         2
## 9     9 C         9</code></pre>
<p>If you only need to modify one or a few variables, you must name it/them when writing the code:</p>
<div class="sourceCode" id="cb253"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/groups.csv"</span>, 
                     delim <span class="op">=</span> <span class="st">","</span>, 
                     col_types <span class="op">=</span> <span class="fu"><a href="https://vroom.r-lib.org/reference/cols.html">cols</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://vroom.r-lib.org/reference/cols.html">col_factor</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The tibble displays like this:</p>
<div class="sourceCode" id="cb254"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">counts</span></code></pre></div>
<pre><code>## # A tibble: 9 × 3
##      ID group count
##   &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt;
## 1     1 A         5
## 2     2 A         3
## 3     3 A         2
## 4     4 B         4
## 5     5 B         5
## 6     6 B         8
## 7     7 C         1
## 8     8 C         2
## 9     9 C         9</code></pre>
<p>Note that <code>col_types</code> is particularly useful when importing tabular data that includes formatted dates.
Dates are usually recognized as <code>character</code> when their format does not match the expected format set as default (locale, etc).
In the following example, dates entered as <code>yyyy-mm-dd</code> in the last column are recognized as of type <code>date</code>:</p>
<div class="sourceCode" id="cb256"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">countsdates</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/groups-dates1.csv"</span>, 
                     delim <span class="op">=</span> <span class="st">","</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 9 Columns: 4</code></pre>
<pre><code>## ── Column specification ──────────────────────────────────────
## Delimiter: ","
## chr  (1): group
## dbl  (2): ID, count
## date (1): date</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>However, in the example below, dates entered as <code>dd-mm-yyyy</code> are converted to <code>character</code>:</p>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">countsdates</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/groups-dates2.csv"</span>, 
                     delim <span class="op">=</span> <span class="st">","</span><span class="op">)</span></code></pre></div>
<pre><code>## Rows: 9 Columns: 4</code></pre>
<pre><code>## ── Column specification ──────────────────────────────────────
## Delimiter: ","
## chr (2): group, date
## dbl (2): ID, count</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>To solve this issue, add the function <code><a href="https://vroom.r-lib.org/reference/cols.html">col_date()</a></code> in <code><a href="https://vroom.r-lib.org/reference/cols.html">cols()</a></code> to help R understand how dates are formatted and shall be read.</p>
<div class="sourceCode" id="cb264"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">countsdates</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/groups-dates2.csv"</span>, 
                     delim <span class="op">=</span> <span class="st">","</span>,
                     col_types <span class="op">=</span> <span class="fu"><a href="https://vroom.r-lib.org/reference/cols.html">cols</a></span><span class="op">(</span>date <span class="op">=</span> <span class="fu"><a href="https://vroom.r-lib.org/reference/cols.html">col_date</a></span><span class="op">(</span><span class="st">"%d-%m-%Y"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The result is the following tibble now correctly formatted:</p>
<div class="sourceCode" id="cb265"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">countsdates</span> </code></pre></div>
<pre><code>## # A tibble: 9 × 4
##      ID group count date      
##   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;date&gt;    
## 1     1 A         5 2021-03-01
## 2     2 A         3 2021-03-02
## 3     3 A         2 2021-03-03
## 4     4 B         4 2021-03-01
## 5     5 B         5 2021-03-02
## 6     6 B         8 2021-03-03
## 7     7 C         1 2021-03-01
## 8     8 C         2 2021-03-02
## 9     9 C         9 2021-03-03</code></pre>
<p>You will find the whole list of <code><a href="https://vroom.r-lib.org/reference/cols.html">cols()</a></code> parameters for <code>col_types</code> <a href="https://readr.tidyverse.org/reference/cols.html" target="_blank">here</a>.</p>
</div>
</div>
<div id="exercise-20" class="section level3 unnumbered facta toc-ignore">
<h3>Exercise<a class="anchor" aria-label="anchor" href="#exercise-20"><i class="fas fa-link"></i></a>
</h3>
<p>Download the midge data from <a href="https://www.ncei.noaa.gov/pub/data/paleo/insecta/chironomidae/northamerica/usa/alaska/alaska2011midge-t.txt">https://www.ncei.noaa.gov/pub/data/paleo/insecta/chironomidae/northamerica/usa/alaska/alaska2011midge-t.txt</a> and import part “3a. Clegg et al. 2011 Hudson Lake Midge Temperature Data”</p>
<details><summary>
Hint
</summary>
What is the delimiter?
Choose an suitable <code>read_*()</code> function
<code>skip</code> and
<code>n_max</code> argument can be useful.
</details>
</div>
<div id="further-reading-2" class="section level3 unnumbered literature toc-ignore">
<h3>Further Reading<a class="anchor" aria-label="anchor" href="#further-reading-2"><i class="fas fa-link"></i></a>
</h3>
<p>You may find the following links useful:</p>
<ul>
<li><a href="https://r4ds.had.co.nz/data-import.html" target="_blank">R for Data Science - Data import</a></li>
<li><a href="https://github.com/rstudio/cheatsheets/raw/master/data-import.pdf" target="_blank">Data Import Cheatsheet - readr/tidyr</a></li>
<li><a href="https://readr.tidyverse.org/" target="_blank">readr</a></li>
</ul>
</div>
<div id="contributors-2" class="section level3 unnumbered contributors toc-ignore">
<h3>Contributors<a class="anchor" aria-label="anchor" href="#contributors-2"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Jonathan Soulé</li>
<li>Aud Halbritter</li>
<li>Richard Telford</li>
</ul>
</div>
</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="first-steps-in-r.html"><span class="header-section-number">3</span> First steps in R</a></div>
<div class="next"><a href="pipes.html"><span class="header-section-number">5</span> Pipes</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li>
<a class="nav-link" href="#importing-data-in-r"><span class="header-section-number">4</span> Importing data in R</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#before-we-start-2">Before we start</a></li></ul>
</li>
<li><a class="nav-link" href="#what-are-tabular-data"><span class="header-section-number">4.1</span> What are tabular data?</a></li>
<li><a class="nav-link" href="#about-tidy-data"><span class="header-section-number">4.2</span> About tidy data</a></li>
<li>
<a class="nav-link" href="#file-formats"><span class="header-section-number">4.3</span> File formats</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#the-csv-format"><span class="header-section-number">4.3.1</span> The CSV format</a></li></ul>
</li>
<li><a class="nav-link" href="#know-your-data"><span class="header-section-number">4.4</span> Know your data!</a></li>
<li>
<a class="nav-link" href="#import-with-readr"><span class="header-section-number">4.5</span> Import with readr</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#read_delim"><span class="header-section-number">4.5.1</span> read_delim()</a></li>
<li><a class="nav-link" href="#read_csv"><span class="header-section-number">4.5.2</span> read_csv()</a></li>
<li><a class="nav-link" href="#white-space-delimited-files"><span class="header-section-number">4.5.3</span> White space delimited files</a></li>
<li><a class="nav-link" href="#exercise-19">Exercise</a></li>
<li><a class="nav-link" href="#useful-arguments"><span class="header-section-number">4.5.4</span> Useful arguments</a></li>
<li><a class="nav-link" href="#exercise-20">Exercise</a></li>
<li><a class="nav-link" href="#further-reading-2">Further Reading</a></li>
<li><a class="nav-link" href="#contributors-2">Contributors</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Working in R</strong>" was written by Jonathan Soulé, Aud Halbritter and Richard J Telford. It was last built on 2021-09-08.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
